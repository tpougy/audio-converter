<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Converta arquivos de áudio .opus para .mp3 localmente no seu navegador. Privado, rápido e funciona offline.">
  <meta name="theme-color" content="#0d6efd">

  <title>Opus to MP3 Converter</title>

  <link rel="manifest" href="/manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/icons/icon-192.png">
  <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css" rel="stylesheet" crossorigin="anonymous">
  <link href="/assets/styles/custom.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-4">
    <header class="text-center mb-4">
      <h1 class="h3 fw-bold text-primary">
        <i class="bi bi-music-note-beamed me-2" aria-hidden="true"></i>
        Opus2MP3
      </h1>
      <p class="text-muted mb-0">Converta áudios .opus para .mp3</p>
    </header>

    <main>
      <div class="card shadow-sm mx-auto" style="max-width: 500px;">
        <div class="card-body p-4">

          <!-- Estado Inicial -->
          <div id="state-initial">
            <div
              id="drop-zone"
              class="drop-zone text-center p-5 rounded-3 border border-2 border-dashed"
              role="button"
              tabindex="0"
              aria-label="Clique ou arraste um arquivo de áudio para converter"
            >
              <i class="bi bi-cloud-arrow-up display-1 text-primary mb-3" aria-hidden="true"></i>
              <p class="mb-2 fw-semibold">Arraste um arquivo aqui</p>
              <p class="text-muted small mb-3">ou clique para selecionar</p>
              <span class="badge bg-secondary">.opus .ogg</span>
            </div>
            <input
              type="file"
              id="file-input"
              class="d-none"
              accept="audio/opus,audio/ogg,audio/*,.opus,.ogg"
              aria-label="Selecionar arquivo de áudio"
            >
            <p class="text-muted text-center small mt-3 mb-0">
              <i class="bi bi-shield-check me-1" aria-hidden="true"></i>
              Processamento 100% local. Seus arquivos não são enviados a nenhum servidor.
            </p>
          </div>

          <!-- Estado Preview -->
          <div id="state-preview" class="d-none">
            <div class="d-flex align-items-center mb-4">
              <div class="bg-primary bg-opacity-10 rounded-3 p-3 me-3">
                <i class="bi bi-file-earmark-music fs-3 text-primary" aria-hidden="true"></i>
              </div>
              <div class="flex-grow-1 overflow-hidden">
                <p id="file-name" class="fw-semibold mb-1 text-truncate"></p>
                <p class="text-muted small mb-0">
                  <span id="file-size"></span>
                  <span class="mx-1">•</span>
                  <span id="file-type"></span>
                </p>
              </div>
            </div>
            <div class="d-grid gap-2">
              <button
                id="btn-convert"
                class="btn btn-primary btn-lg"
                type="button"
              >
                <i class="bi bi-arrow-repeat me-2" aria-hidden="true"></i>
                Converter para MP3
              </button>
              <button
                id="btn-select-another"
                class="btn btn-outline-secondary"
                type="button"
              >
                Selecionar outro arquivo
              </button>
            </div>
          </div>

          <!-- Estado Carregando FFmpeg -->
          <div id="state-loading" class="d-none text-center py-4">
            <div class="spinner-border text-primary mb-3" role="status">
              <span class="visually-hidden">Carregando...</span>
            </div>
            <p class="fw-semibold mb-1">Carregando conversor...</p>
            <p class="text-muted small mb-0">Isso pode levar alguns segundos na primeira vez</p>
          </div>

          <!-- Estado Convertendo -->
          <div id="state-converting" class="d-none">
            <div class="text-center mb-3">
              <i class="bi bi-gear-wide-connected fs-1 text-primary spinning" aria-hidden="true"></i>
            </div>
            <div class="progress mb-3" style="height: 24px;" role="progressbar" aria-label="Progresso da conversão">
              <div
                id="progress-bar"
                class="progress-bar progress-bar-striped progress-bar-animated"
                style="width: 0%"
                aria-valuenow="0"
                aria-valuemin="0"
                aria-valuemax="100"
              >
                <span id="progress-text" class="fw-semibold">0%</span>
              </div>
            </div>
            <p id="progress-message" class="text-center text-muted mb-3"></p>
            <div class="d-grid">
              <button
                id="btn-cancel"
                class="btn btn-outline-danger"
                type="button"
              >
                <i class="bi bi-x-circle me-2" aria-hidden="true"></i>
                Cancelar
              </button>
            </div>
          </div>

          <!-- Estado Concluído -->
          <div id="state-completed" class="d-none">
            <div class="text-center mb-4">
              <div class="bg-success bg-opacity-10 rounded-circle d-inline-flex p-4 mb-3">
                <i class="bi bi-check-circle-fill fs-1 text-success" aria-hidden="true"></i>
              </div>
              <h2 class="h5 fw-bold text-success mb-2">Conversão Concluída!</h2>
              <p id="output-file-name" class="text-muted mb-0"></p>
            </div>
            <div class="d-grid gap-2">
              <button
                id="btn-share"
                class="btn btn-primary btn-lg"
                type="button"
              >
                <i class="bi bi-share me-2" aria-hidden="true"></i>
                Compartilhar MP3
              </button>
              <button
                id="btn-download"
                class="btn btn-outline-primary"
                type="button"
              >
                <i class="bi bi-download me-2" aria-hidden="true"></i>
                Baixar MP3
              </button>
              <button
                id="btn-convert-another"
                class="btn btn-outline-secondary"
                type="button"
              >
                Converter outro arquivo
              </button>
            </div>
          </div>

          <!-- Estado de Erro -->
          <div id="state-error" class="d-none">
            <div class="text-center mb-4">
              <div class="bg-danger bg-opacity-10 rounded-circle d-inline-flex p-4 mb-3">
                <i class="bi bi-exclamation-triangle-fill fs-1 text-danger" aria-hidden="true"></i>
              </div>
              <h2 class="h5 fw-bold text-danger mb-2">Ocorreu um erro</h2>
              <p id="error-message" class="text-muted mb-0"></p>
            </div>
            <div class="d-grid gap-2">
              <button
                id="btn-retry"
                class="btn btn-primary"
                type="button"
              >
                <i class="bi bi-arrow-clockwise me-2" aria-hidden="true"></i>
                Tentar novamente
              </button>
            </div>
          </div>

        </div>
      </div>
    </main>

    <footer class="text-center mt-4">
      <p class="text-muted small mb-0">
        <i class="bi bi-lock-fill me-1" aria-hidden="true"></i>
        Processamento local • Funciona offline
      </p>
    </footer>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>
